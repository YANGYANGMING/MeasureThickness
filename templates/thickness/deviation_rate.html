{% extends 'index.html' %}
{% load staticfiles %}

{% block right-content-container %}

    <div style="padding: 15px; margin-top: -40px" class="layui-anim">
        <fieldset class="layui-elem-field layui-field-title" style="margin-top: 30px;">
          <legend>偏差率柱状图</legend>
        </fieldset>
    <div id="container" style="min-width:400px;height:400px"></div>

    <script type="text/javascript" src="/static/plugins/formselects/dist/formSelects-v4.min.js"></script>
    <script>

         Highcharts.setOptions({
            global: {
                useUTC: false
            }
        });

        $(function(){
            initChart();
            console.log({{ nid }})
         });

        function initChart() {
            var chart = {
                chart: {
                    type: 'column'
                },
                title: {
                    text: '偏差率'
                },
                xAxis: {
                    categories: [
                        '0.1','0.2','0.3','0.4','0.5','0.6','0.7','0.8','0.9','1.0','>=1.0'
                    ],
                    title: {
                        text: '偏差量'
                    },
                    crosshair: true
                },
                tooltip: {
                    // head + 每个 point + footer 拼接成完整的 table
                    headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
                    pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                    '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
                    footerFormat: '</table>',
                    shared: true,
                    useHTML: true
                },
                plotOptions: {
                    column: {
                        borderWidth: 0
                    }
                },
                series: [{
                    name: '东京sd',
                    data: [0.9, -0.1, 0.4, 0.2, 0.2, 0.0, 0.6, 0.5, 0.4, 0.1, 0.1]
                }, {
                    name: '纽约sds',
                    data: [0.6, 0.8, 0.5, 0.4, 0.5, 0.5, 0.0, 0.3, 0.2, 0.5, 0.1]
                }, {
                    name: '伦敦sdf',
                    data: [0.9, 0.8, 0.3, 0.4, 0.0, 0.3, 0.0, 0.6, 0.4, 0.2, 0.1]
                }, {
                    name: '柏林sdf',
                    data: [0.4, 0.2, 0.5, 0.7, 0.6, 0.5, 0.4, 0.4, 0.6, 0.1, 0.1]
                }, {
                    name: '中国sdf',
                    data: [0.6, 0.8, 0.5, 0.4, 0.1, 0.5, 0.0, 0.3, 0.2, 0.5, 0.1]
                }]
            };
            //chart['series'] = [];
            $.ajax({
                url: '/thickness/deviation-rate-ajax/{{ nid }}/',
                type: 'POST',
                dataType: 'JSON',
                success: function (arg) {
                    if (arg.status){
                        console.log(arg)
                        //chart['series'] = [];
                    }
                }
            });
            $('#container').highcharts(chart);
        }



    </script>
{% endblock %}










